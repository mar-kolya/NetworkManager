From: Nikolay Martynov <mar.kolya@gmail.com>
Date: Sun, 21 May 2017 17:07:17 -0400
Subject: Bond: add support for cloned mac

---
 clients/tui/nmt-page-bond.c  | 6 ++++++
 libnm-core/nm-setting-bond.c | 4 ++++
 2 files changed, 10 insertions(+)

diff --git a/clients/tui/nmt-page-bond.c b/clients/tui/nmt-page-bond.c
index 48070db..732a145 100644
--- a/clients/tui/nmt-page-bond.c
+++ b/clients/tui/nmt-page-bond.c
@@ -361,6 +361,12 @@ nmt_page_bond_constructed (GObject *object)
 	nmt_editor_grid_append (grid, NULL, widget, NULL);
 	priv->slaves = NMT_SLAVE_LIST (widget);
 
+	widget = nmt_mac_entry_new (40, ETH_ALEN, NMT_MAC_ENTRY_TYPE_CLONED);
+	g_object_bind_property (s_bond, NM_SETTING_WIRED_CLONED_MAC_ADDRESS,
+	                        widget, "mac-address",
+	                        G_BINDING_BIDIRECTIONAL | G_BINDING_SYNC_CREATE);
+	nmt_editor_grid_append (grid, _("Cloned MAC address"), widget, NULL);
+
 	widget = nmt_newt_popup_new (bond_mode);
 	g_signal_connect (widget, "notify::active-id",
 	                  G_CALLBACK (mode_widget_changed), bond);
diff --git a/libnm-core/nm-setting-bond.c b/libnm-core/nm-setting-bond.c
index 9a8bdc3..dd94dc0 100644
--- a/libnm-core/nm-setting-bond.c
+++ b/libnm-core/nm-setting-bond.c
@@ -49,11 +49,15 @@ NM_SETTING_REGISTER_TYPE (NM_TYPE_SETTING_BOND)
 #define NM_SETTING_BOND_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), NM_TYPE_SETTING_BOND, NMSettingBondPrivate))
 
 typedef struct {
+	char *cloned_mac_address;
+	char *generate_mac_address_mask;
 	GHashTable *options;
 } NMSettingBondPrivate;
 
 enum {
 	PROP_0,
+	PROP_CLONED_MAC_ADDRESS,
+	PROP_GENERATE_MAC_ADDRESS_MASK,
 	PROP_OPTIONS,
 	LAST_PROP
 };
